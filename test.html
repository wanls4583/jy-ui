<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>history 测试</title>
</head>

<body>
    <p><input type="text" value="0" id="oTxt" /></p>
    <p><input type="button" value="+" id="oBtn" /></p>
    <script>
        var otxt = document.getElementById("oTxt");
        var oBtn = document.getElementById("oBtn");
        var n = 0;

        oBtn.addEventListener("click", function () {
            n++;
            add();
        }, false);
        get();

        function add() {
            if ("onhashchange" in window) { //如果浏览器的原生支持该事件
                window.location.hash = "#" + n;
            }
        }

        function get() {
            if ("onhashchange" in window) { //如果浏览器的原生支持该事件
                window.addEventListener("hashchange", function (e) {
                    var hashVal = window.location.hash.substring(1);
                    if (hashVal) {
                        n = hashVal;
                        otxt.value = n;
                    }
                }, false);
            }
        }

        window.addEventListener('popstate', function(e) {
            console.log(e);
        }, false);
    </script>
</body>

</html>